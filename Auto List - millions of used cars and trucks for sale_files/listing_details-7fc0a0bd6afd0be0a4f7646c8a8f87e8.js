//TODO make a CarFax Controller and eliminate this file
$(document).ready(function(){$("#back_to_search, .goBack").live("click",function(){$("#back-to-search").attr("href")||window.history.back(),trigger_custom_event("vdp_return_to_search")}),jsFeaturesEnabled.ldp_carfax_highlights&&carfax_highlights_handler.fetch_highlights(),$(".truncate").truncate({max_length:300})});var carfax_highlights_handler={fetch_highlights:function(){var a=$(".vin_field").text().trim();$.get("/listings/carfax_report",{vin:a}).success(carfax_highlights_handler.process_results)},process_results:function(a){if(!$.isEmptyObject(a)){var b=$(".vin_field").text().trim();$("#carfax_wrapper .disclaimer").html(a.Disclaimer),$(".carfax_ownership").text(a.Ownership),delete a.Disclaimer;var c=$(".carfax_highlights ul"),d=[];for(var e in a)a.hasOwnProperty(e)&&d.push(e);$(d).each(function(b,d){c.append("<li>"+a[d]+"</li>")}),a.Ownership=="CARFAX 1-Owner"&&$(".carfax_link img").attr("src","/assets/show_carfax_1.gif"),$(".vin_field a").attr("href",carfax_highlights_handler.carfax_url(b)),$(".cf_report").removeClass("cf_report"),$(".carfax_link").click(function(){$(".carfax_highlights").toggle(),$.trim($("span.state").text())=="View"?$("span.state").text("Hide"):$("span.state").text("View")})}},carfax_url:function(a){return"http://www.carfax.com/VehicleHistory/p/Report.cfx?partner=VBR_0&vin="+a}};